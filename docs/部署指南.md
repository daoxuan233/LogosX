# 部署指南（本地）

## 1. 运行原则

- **应用本身不使用 Docker 部署**（纯 Python 本地运行）。
- 但搜索基础设施建议本地启动：
  - SearXNG（推荐用仓库自带 searxng-docker）
  - Redis Stack（用于向量缓存与语义检索）
- 书记员 Agent 不需要额外基础设施，但会额外调用一次 LLM（按轮处理）。

## 2. Python 运行环境（uv）

建议使用 Python 3.11+。
使用 uv 创建虚拟环境并安装依赖（示例）：

```bash
uv venv
uv pip install -e .
```

然后在项目根目录创建 `.env`：

- 复制 `.env.example` → `.env`
- 填写 `XIAOMIMIMO_API_KEY`

## 3. 启动 SearXNG（可选但推荐）

仓库提供 `searxng-docker/`：
- 端口映射：本机 `8081` → 容器 `8080`
- 输出格式包含 `json`

启动后确保 `.env` 中：

- `SEARXNG_BASE_URL=http://localhost:8081`

## 4. 启动 Redis Stack（推荐）

你可以用本地安装或 Docker 启动 Redis Stack。
确保 `.env` 中：

- `REDIS_URL=redis://localhost:6379/0`

## 5. 验证

在项目根目录运行最小回归（建议先 1~2 轮）：
```bash
uv run debate-arena run --topic "德性即知识是否成立？" --rounds 2 --west guy_debord --east zhuangzi
```

确认 `outputs/` 下生成：

- `辩论_*.md`（结构化实录）
- `辩论_*_书记员版.md`（书记员整理版，默认开启）

若你只想验证结构化实录，可临时关闭书记员输出：

```bash
uv run debate-arena run --topic "德性即知识是否成立？" --rounds 2 --west guy_debord --east zhuangzi --no-clerk
```
